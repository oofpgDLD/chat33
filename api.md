## IM服务端api文档

## 约定
- datetime均为时间戳，单位：毫秒
- http的`POST`请求：request body和返回结果均为`JSON` 格式
- 所有请求需包含`Header`如下
    - `FZM-AUTH-TOKEN`（用户token）
    - `FZM-DEVICE`（设备类型：iOS、Android、PC）
    - `FZM-UUID`（设备mac）
    - `FZM-DEVICE-NAME`（设备名称）
    - `FZM-APP-ID`（[应用类型AppId](#AppId)）
- 统一返回结果：
    - 采用自定义错误：http status:`200` 
    - `result`: `0`代表成功；非0表错误（[统一错误代码](#统一错误代码)）。
    - `message`:错误文本提示。
    - `data`: 返回数据。

## 统一错误代码
```
-1000 数据库连接失败
-1001 参数错误
-1002 缺少参数
-1003 Session错误
-1004 登录过期
-1005 消息格式错误
-1006 未知的设备类型
-1007 账号已经在其他终端登录
-1010 查询数据库失败
-1011 写入数据库失败
-1012 发送频率过快，请稍后再试
-2001 用户不存在
-2002 用户已存在
-2004 登录验证失败
-2006 用户没有发系统消息权限
-2007 用户被禁言
-2009 没有给普通用户发私聊权限
-2017 已经是好友关系
-2018 对方不是您的好友
-2019 好友请求已经被处理
-2020 好友请求不存在
-2021 不能对自己进行操作
-2022 数据转换异常
-2023 删除消息失败
-3000 权限不足
-3001 用户没有加入聊天群权限
-6000 查询聊天记录失败
-7000 消息格式错误
-8000 获取手机验证码失败
-9000 服务端内部错误
```

## AppId
*注*：appId可自定义
- 1001 找币
- 1002 敢么
- 1003 医疗连

### 用户模块
#### 发送邮箱验证码【/sendEmail】
Method：`post`

Request Params：`application/json`

| **参数** | **名字**       | **类型** | **约束** | **说明**                              |
| -------- | -------------- | -------- | -------- | ------------------------------------- |
| email       | 邮箱 | string   | 必填     |  |

Response Body：
> 无
```json
{
	"result": 0,
	"message": "操作成功",
	"data": {
	}
}
```

#### 发送手机验证码【/sendCode】
Method：`post`

Request Params：`application/json`

| **参数** | **名字**       | **类型** | **约束** | **说明**                              |
| -------- | -------------- | -------- | -------- | ------------------------------------- |
| phone       | 手机号 | string   | 必填     |  |

Response Body：
> 无
```json
{
	"result": 0,
	"message": "操作成功",
	"data": {
	}
}
```

#### 验证并获取token【/validateCode】
Method：`post`

Request Params：`application/json`

| **参数** | **名字**       | **类型** | **约束** | **说明**                              |
| -------- | -------------- | -------- | -------- | ------------------------------------- |
| type       | 类型 | uint   | 必填     | 0：手机；1：邮箱 |
| email   | 邮箱           | string      | 非必填     |                                |
| phone       | 手机号 | string   | 非必填     |  |
| code   | 验证码           | string      | 必填     |                                       |

Response Body：

| **参数** | **名字** | **类型** | **说明**                              |
| -------- | -------------- | -------- | ------------------------------------- |
| type       | 类型 | uint   |  0:注册；1：登录 |
| token   | 授权token  | string   |  |

```json
{
	"result": 0,
	"message": "操作成功",
	"data": {
        "type": 0,
        "token": "123"
	}
}
```

#### 手机号登录【/phoneLogin】
Method：`post`

Request Params：`application/json`

| **参数** | **名字**       | **类型** | **约束** | **说明**                              |
| -------- | -------------- | -------- | -------- | ------------------------------------- |
| phone       | 手机号 | string   | 必填     |  |
| code   | 验证码           | string      | 必填     |                                       |

Response Body：
| **参数** | **名字** | **类型** | **说明**                              |
| -------- | -------------- | -------- | ------------------------------------- |
| type       | 类型 | uint   |  0:注册；1：登录 |
| token   | 授权token  | string   |  |

```json
{
	"result": 0,
	"message": "操作成功",
	"data": {
        "type": 0,
        "token": "123"
	}
}
```